<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ë‚˜ì˜ ì„ íƒê³¼ ì§‘ì¤‘ ëŒ€ì‹œë³´ë“œ</title>
<style>
:root{
  --bg:#0b1020; --card:#121a33; --text:#e9eeff; --muted:#8ea0c9;
  --line:rgba(255,255,255,.10); --accent:#7c5cff; --ok:#3ddc97; --danger:#ff6b6b;
}
*{box-sizing:border-box}
body{
  margin:0;font-family:system-ui,-apple-system,"Apple SD Gothic Neo","Noto Sans KR",sans-serif;
  background:linear-gradient(180deg,#0b1020,#0e1430);color:var(--text)
}
.wrap{max-width:920px;margin:0 auto;padding:18px}
h1{margin:0 0 6px}
.sub{color:var(--muted);font-size:14px;margin:0 0 16px;line-height:1.45}

.card{
  background:var(--card);border:1px solid var(--line);
  border-radius:16px;padding:14px;margin-bottom:14px
}
.topbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
.btnrow{display:flex;gap:10px;flex-wrap:wrap}
button{
  border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text);
  padding:9px 12px;border-radius:12px;font-size:13px;cursor:pointer
}
button:hover{border-color:rgba(124,92,255,.35)}
.danger:hover{border-color:rgba(255,107,107,.55)}

.section-title{font-size:15px;margin:0 0 10px}
.small{font-size:12px;color:var(--muted);font-weight:600}

.item{
  display:flex;gap:10px;align-items:flex-start;
  padding:10px;border-radius:12px;border:1px solid var(--line);
  margin-bottom:8px;background:rgba(0,0,0,.15)
}
input[type=checkbox]{width:18px;height:18px;margin-top:2px;accent-color:var(--accent)}
.desc{font-size:12px;color:var(--muted);margin-top:4px;line-height:1.4}

textarea{
  width:100%;min-height:120px;background:rgba(0,0,0,.2);
  border:1px solid var(--line);border-radius:12px;padding:10px;
  color:var(--text);font-size:13px;resize:vertical;line-height:1.5;outline:none
}

.progress{height:10px;background:rgba(255,255,255,.08);border-radius:999px;overflow:hidden;margin-top:12px}
.bar{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--ok))}

.kpi{display:flex;gap:10px;margin-top:10px}
.kpi .box{
  flex:1;background:rgba(0,0,0,.2);border:1px solid var(--line);
  border-radius:12px;padding:10px
}
.num{font-size:22px;font-weight:800;margin-top:6px}

.listCard{
  border:1px solid var(--line);border-radius:12px;padding:10px;margin-top:10px;
  background:rgba(0,0,0,.12)
}
pre{white-space:pre-wrap;margin:8px 0 0;color:var(--text);font-family:inherit;font-size:13px;line-height:1.5}
hr{border:0;border-top:1px solid var(--line);margin:12px 0}
footer{color:var(--muted);font-size:12px;margin-top:10px;line-height:1.5}
</style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="topbar">
      <div>
        <h1>ë‚˜ì˜ ì„ íƒê³¼ ì§‘ì¤‘ ëŒ€ì‹œë³´ë“œ</h1>
        <div class="sub">ì²´í¬/ì¼ê¸°ëŠ” ìë™ ì €ì¥(ë‚ ì§œë³„) Â· ì§„í–‰ë¥  ì¦‰ì‹œ ë°˜ì˜</div>
        <div class="small">ì˜¤ëŠ˜ ë‚ ì§œ: <span id="dateLabel"></span></div>
      </div>
      <div class="btnrow">
        <button id="btnTodayReset">ì˜¤ëŠ˜ë§Œ ë¦¬ì…‹</button>
        <button class="danger" id="btnClearAll">ì „ì²´ ì´ˆê¸°í™”</button>
      </div>
    </div>
  </div>

  <!-- ğŸŒ… ì•„ì¹¨ -->
  <div class="card" id="am">
    <div class="section-title">ğŸŒ… ì•„ì¹¨ ë£¨í‹´</div>

    <div class="item"><input type="checkbox" data-key="med"><div><b>ë§ˆìŒì±™ê¹€ ëª…ìƒ</b><div class="desc">5~10ë¶„, ê·¸ëƒ¥ ì•‰ê¸°</div></div></div>
    <div class="item"><input type="checkbox" data-key="run"><div><b>ëŸ¬ë‹/ë¹ ë¥¸ ê±·ê¸°</b><div class="desc">20~40ë¶„</div></div></div>
    <div class="item"><input type="checkbox" data-key="strength"><div><b>ê·¼ë ¥ìš´ë™ 20ë¶„</b></div></div>
    <div class="item"><input type="checkbox" data-key="dogwalk"><div><b>ê°•ì•„ì§€ ì‚°ì±…</b></div></div>
  </div>

  <!-- ğŸŒ™ ì €ë… -->
  <div class="card" id="pm">
    <div class="section-title">ğŸŒ™ ì €ë… ë£¨í‹´</div>

    <div class="item"><input type="checkbox" data-key="diet"><div><b>ì‹ë‹¨ ì¡°ì ˆ</b><div class="desc">ì ìƒ‰ìœ¡/ì†Œê¸ˆë¬¼/ë²„í„° ì„­ì·¨ ì˜ì‹</div></div></div>
    <div class="item"><input type="checkbox" data-key="omad"><div><b>1ì¼ 1ì‹</b></div></div>
    <div class="item"><input type="checkbox" data-key="save"><div><b>ì ˆì•½: ëˆ ì•ˆ ì“°ê¸°</b></div></div>
    <div class="item"><input type="checkbox" data-key="simplify"><div><b>ìƒí™œ ë‹¨ìˆœí™”: ë¶ˆí•„ìš” 1ê°œ ì‚­ì œ</b></div></div>
    <div class="item"><input type="checkbox" data-key="gear"><div><b>ëŸ°ë‹ì¡°ë¼/ë…¸íŠ¸ë¶ ì¤€ë¹„</b></div></div>
    <div class="item"><input type="checkbox" data-key="computer"><div><b>ì»´ ê°€ê¹Œì´ ë£¨í‹´ 1íšŒ</b><div class="desc">25ë¶„ ì§‘ì¤‘ + ê¸°ë¡</div></div></div>
    <div class="item"><input type="checkbox" data-key="lifeplan"><div><b>ì¸ìƒ ê³„íš 10ë¶„</b></div></div>
    <div class="item"><input type="checkbox" data-key="esteem"><div><b>ìì¡´ê° ì±„ìš°ê¸°</b><div class="desc">ì˜¤ëŠ˜ ì˜í•œ ê²ƒ 1ê°œ ì ê¸°</div></div></div>

    <div class="item"><input type="checkbox" data-key="eng"><div><b>ì˜ì–´ ì–´í”Œ 15ë¶„</b></div></div>
    <div class="item"><input type="checkbox" data-key="worksheet"><div><b>í•™ìŠµì§€ 1íšŒ</b></div></div>
    <div class="item"><input type="checkbox" data-key="friend"><div><b>ì™¸êµ­ì¸ ì¹œêµ¬ í–‰ë™ 1ê°œ</b></div></div>

    <div class="item"><input type="checkbox" data-key="dogcare"><div><b>ê°•ì•„ì§€ ì¼€ì–´</b><div class="desc">ì–‘ì¹˜(ë§¤ì¼) / ëª©ìš•Â·ìœ„ìƒ(í•„ìš”ì‹œ)</div></div></div>
  </div>

  <!-- ğŸ“– ì¼ê¸° -->
  <div class="card">
    <div class="section-title">ğŸ“– ì˜¤ëŠ˜ ì¼ê¸° (ë‚ ì§œë³„ ì €ì¥)</div>
    <textarea id="journal" placeholder="1) ì˜¤ëŠ˜ í•œ ì¼&#10;2) ëŠë‚€ ì &#10;3) ë‚´ì¼ì˜ í•œ ê°€ì§€"></textarea>

    <div class="btnrow" style="margin-top:10px;justify-content:flex-end">
      <button id="btnDiaryList">ğŸ“š ì¼ê¸° ê¸°ë¡ ë³´ê¸°</button>
      <button id="btnDiaryExport">â¬‡ï¸ ì¼ê¸° ë°±ì—…(JSON)</button>
    </div>

    <div id="diaryList" style="display:none;"></div>
  </div>

  <!-- ğŸ“Š ì§„í–‰ë¥  -->
  <div class="card">
    <div class="progress"><div class="bar" id="bar"></div></div>
    <div class="kpi">
      <div class="box">ì˜¤ëŠ˜ ì§„í–‰ë¥ <div class="num" id="percent">0%</div></div>
      <div class="box">ì™„ë£Œ í•­ëª©<div class="num"><span id="done">0</span>/<span id="total">0</span></div></div>
    </div>
  </div>

  <footer>
    âœ” ì´ í˜ì´ì§€ì˜ ì²´í¬/ì¼ê¸° ë°ì´í„°ëŠ” <b>ì´ ë¸Œë¼ìš°ì €(LocalStorage)</b>ì—ë§Œ ì €ì¥ë©ë‹ˆë‹¤.<br/>
    âœ” í°ì„ ë°”ê¾¸ê±°ë‚˜ ë¸Œë¼ìš°ì € ë°ì´í„°ë¥¼ ì§€ìš°ë©´ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš” â†’ â€œì¼ê¸° ë°±ì—…(JSON)â€ ê¶Œì¥.
  </footer>
</div>

<script>
const $$ = s => Array.from(document.querySelectorAll(s));
const $ = s => document.querySelector(s);
const STORAGE_KEY = "focus_dashboard_v2";

const todayKey = () => new Date().toISOString().slice(0,10);

function load(){
  try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}"); }
  catch(e){ return {}; }
}
function save(v){ localStorage.setItem(STORAGE_KEY, JSON.stringify(v)); }

const state = load();
if(!state.daily) state.daily = {};
if(!state.journals) state.journals = {};
const T = todayKey();
if(!state.daily[T]) state.daily[T] = {};

$("#dateLabel").textContent = T;

function boxes(){
  return $$("input[type=checkbox][data-key]");
}

function update(){
  const b = boxes();
  const total = b.length;
  const done = b.filter(x => x.checked).length;
  const pct = total ? Math.round(done/total*100) : 0;
  $("#done").textContent = done;
  $("#total").textContent = total;
  $("#percent").textContent = pct + "%";
  $("#bar").style.width = pct + "%";
}

boxes().forEach(b=>{
  const k = b.dataset.key;
  b.checked = !!state.daily[T][k];
  b.addEventListener("change", ()=>{
    state.daily[T][k] = b.checked;
    save(state);
    update();
  });
});

// ì¼ê¸°: ë‚ ì§œë³„
const journal = $("#journal");
journal.value = state.journals[T] || "";
journal.addEventListener("input", ()=>{
  state.journals[T] = journal.value;
  save(state);
});

// ì¼ê¸° ëª©ë¡
function esc(s){ return (s||"").replace(/</g,"&lt;"); }

function renderDiaryList(){
  const box = $("#diaryList");
  const entries = Object.entries(state.journals || {})
    .filter(([d, txt]) => (txt||"").trim().length > 0)
    .sort((a,b)=> b[0].localeCompare(a[0]));

  if(entries.length === 0){
    box.innerHTML = `<div class="small">ì•„ì§ ì €ì¥ëœ ì¼ê¸°ê°€ ì—†ì–´ìš”.</div>`;
    return;
  }

  box.innerHTML = entries.map(([d, txt]) => `
    <div class="listCard">
      <div class="topbar" style="padding:0;margin:0;border:0">
        <b>${d}</b>
        <button class="danger" type="button" data-del="${d}">ì‚­ì œ</button>
      </div>
      <pre>${esc(txt)}</pre>
    </div>
  `).join("");

  box.querySelectorAll("button[data-del]").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      const d = btn.getAttribute("data-del");
      if(!confirm(`${d} ì¼ê¸°ë¥¼ ì‚­ì œí• ê¹Œìš”?`)) return;
      delete state.journals[d];
      save(state);
      renderDiaryList();
    });
  });
}

$("#btnDiaryList").addEventListener("click", ()=>{
  const box = $("#diaryList");
  const open = box.style.display !== "none";
  box.style.display = open ? "none" : "block";
  if(!open) renderDiaryList();
});

$("#btnDiaryExport").addEventListener("click", ()=>{
  const data = { journals: state.journals || {} };
  const blob = new Blob([JSON.stringify(data, null, 2)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "diary-backup.json";
  a.click();
  URL.revokeObjectURL(a.href);
});

$("#btnTodayReset").addEventListener("click", ()=>{
  if(!confirm("ì˜¤ëŠ˜ ì²´í¬ì™€ ì˜¤ëŠ˜ ì¼ê¸°ë§Œ ë¦¬ì…‹í• ê¹Œìš”?")) return;
  state.daily[T] = {};
  state.journals[T] = "";
  save(state);
  boxes().forEach(b=> b.checked = false);
  journal.value = "";
  update();
});

$("#btnClearAll").addEventListener("click", ()=>{
  if(!confirm("ì „ì²´ ë°ì´í„°(ì²´í¬/ì¼ê¸°)ë¥¼ ëª¨ë‘ ì´ˆê¸°í™”í• ê¹Œìš”?")) return;
  localStorage.removeItem(STORAGE_KEY);
  location.reload();
});

update();
</script>
</body>
</html>